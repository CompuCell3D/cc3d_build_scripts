INSTALLATION_DIR=$1

COMPUCELL3D_PKG=compucell3d

if [ -z "$2" ]; then
  echo "Will use default version of CC3D"
else
  VERSION=$2
  COMPUCELL3D_PKG="${COMPUCELL3D_PKG}=${VERSION}"
  echo "Installation directory : $1"
fi

echo ${COMPUCELL3D_PKG}

# get current script dir
SCRIPT_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" &>/dev/null && pwd)"

${SCRIPT_DIR}/Miniconda3-py37_4.10.3-MacOSX-x86_64.sh -s -b -p ${INSTALLATION_DIR}/miniconda3

source ${INSTALLATION_DIR}/miniconda3/bin/activate base

# copying compucell3d.app and twedit++.app 

cp -R ${SCRIPT_DIR}/compucell3d.app ${INSTALLATION_DIR}/miniconda3
cp -R ${SCRIPT_DIR}/twedit++.app ${INSTALLATION_DIR}/miniconda3

cp ${SCRIPT_DIR}/run_scripts/* ${INSTALLATION_DIR}

which python

conda install -y -c compucell3d -c conda-forge ${COMPUCELL3D_PKG}
